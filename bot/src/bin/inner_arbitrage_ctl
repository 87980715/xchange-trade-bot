#!/bin/bash
PARENT_PATH=$( cd "$(dirname "${BASH_SOURCE}")" ; pwd -P )
INNER_INNER_ARBITRAGE_BOT_HOME=`pwd`

case "$1" in
   'start')
    cd $PARENT_PATH/..

    #checking directory logs
    echo $"current directory is $INNER_INNER_ARBITRAGE_BOT_HOME"

    if [ -d $PARENT_PATH/../logs ]; then
     echo $"checking directory logs - exists"
    else
     echo $"checking directory logs - does not exist => creating it .. $PARENT_PATH/../logs"
     mkdir $PARENT_PATH/../logs
     if [ $? == 1 ]; then
      echo $"cannot create the directory"
      exit 1
     fi
    fi

    if [ -f $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid ]; then
     echo $"inner-arbitrage-process is already running"
    else
     nohup java -cp "$PARENT_PATH/../conf/:$PARENT_PATH/../lib/*" com.peterservice.pays.filepay.Application &
     echo $! > $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid
     if [ -f $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid ]; then
      echo $"inner-arbitrage-process is started"
     fi
    fi
    ;;
  'restart')
    $0 stop
    $0 start
    ;;
  'stop')
    if [ -f $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid ] ; then
      kill `cat $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid` > /dev/null 2> /dev/null
      rm -f $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid
      sleep 2
    else
    echo $"inner-arbitrage-process is not running"
    fi
    ;;
  'status')
    if [ -f $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid ]; then
        echo $"inner-arbitrage-process is running now `cat $PARENT_PATH/../logs/INNER_ARBITRAGE_BOT.pid`..."
    else
        echo $"inner-arbitrage-process is not running..."
    fi
    ;;
  *)
    echo $"Usage: $0 {start|restart|stop|status}"
    exit 1
    ;;
esac
